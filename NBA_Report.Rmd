---
title: "NBA_Report"
author: "Rita Wang, Teddy Guo, Sara Baji, Camila Diaz"
date: "`r Sys.Date()`"
params:
  data_path: "raw_data/nba_2025-10-30.csv"
  codebook_path: "raw_data/nba_codebook.xlsx"
  top_n: 10
  cutoff_date: "October 30, 2025"
  outcome_label: "points per 36 minutes"
fontsize: 11pt
geometry: margin=1in
output:
  html_document:
    toc: true
    toc_float: true
    number_sections: true
    code_folding: "show"
    theme: cosmo
    highlight: tango
    df_print: paged
    self_contained: true 
---

```{r, load-packages, include=FALSE}
library(dplyr)
library(tidyverse)
library(here)
library(gtsummary)
library(gt)
library(kableExtra)
```

```{r, setup, include=FALSE}
knitr::opts_knit$set(root.dir = here::here())
data_path <- here::here(params$data_path)
codebook_path <- here::here(params$codebook_path)
```

# Project overview

This project analyzes NBA player performance data sourced from [Basketball Reference](https://www.basketball-reference.com/leagues/NBA_2026_per_minute.html), focusing on **per-36-minute statistics** to compare players on an equal playing-time basis as of `r params$cutoff_date`. The goal is to rank the top `r params$top_n` players using key metrics such as points, assists, rebounds, and efficiency, then summarize overall trends through tables and visualizations. Our primary outcome is `r params$outcome_label`. Subsequent sections will expand on these analyses and introduce a simple predictive model to examine how shooting, rebounding, and passing metrics collectively explain a player's overall scoring output.

# Data Description
```{r, read-data, message=FALSE, warning=FALSE}
nba_data <- readr::read_csv(data_path)
head(nba_data)
```

Each row represents one player's averaged performance metrics.

Key variables include:

- **Points, assists, and rebounds per 36 minutes** — indicators of overall contribution.  
- **Field goal, 3-point, and free throw percentages** — measures of shooting efficiency.  
- **Blocks, steals, turnovers, and fouls** — indicators of defensive and possession-related performance.  
- **Effective field goal percentage** — a combined efficiency measure that adjusts for the added value of 3-point shots.  

These variables allow for ranking players, summarizing league-wide performance patterns, and later building a model to explore how shooting, rebounding, and passing relate to overall scoring output.

## Summary Statistics

```{r, summary-stats, message=FALSE, warning=FALSE}
table1<- readRDS(here::here("output/table1.rds"))
table1
```

Table 1 summarizes overall player performance across 422 NBA athletes. The averages show that players typically contribute around **15 points**, **3 assists**, and **6 rebounds**, though the wide interquartile ranges highlight large variation in offensive roles and productivity. Shooting efficiency is generally consistent league-wide, with **field-goal accuracy near 0.46**, **three-point accuracy around 0.32**, and **free-throw accuracy near 0.76**, resulting in an **effective field-goal rate of roughly 0.54**. These numbers suggest that while elite scorers push the upper range of these metrics, most players maintain balanced scoring efficiency. 


## Graphical Summaries

### Histogram

* Description of the histogram (ideally some important variable about the player statistics)

```{r, histogram, echo=TRUE, message=FALSE, warning=FALSE}

```

### Scatter plot

* Description of the scatter plot (ideally showing important relationships that contribute to our analysis goal - how efficiency and contribution link to scoring)

* please do at least 2 scatter plots

```{r, scatterplots, echo=TRUE, message=FALSE, warning=FALSE}

```

# Player Ranking & Performance Summary 

We next rank the Top `r params$top_n` players and interpret `r params$outcome_label` as of `r params$cutoff_date`.

```{r, player-ranking, echo=TRUE, message=FALSE, warning=FALSE}

```


## Interpretation

* Add interpretation of your ranking anslysis.


# Modeling overview - by Sara Baji

Building on the descriptive summaries above, we will use a linear regression model to evaluate how different aspects of player performance contribute to scoring efficiency. Specifically, we examine how shooting accuracy (field-goal and three-point percentage), rebounding, and passing metrics together explain variation in points per 36 minutes. 


## Regression Modeling

```{r, regression-model, echo=TRUE, message=FALSE, warning=FALSE}
reg_results <- readRDS(here::here("output", "regression.rds"))

reg_results$coef_table %>%
  knitr::kable(
    digits = 3,
    caption = "Regression model predicting points per 36 minutes."
  )

reg_results$fit_stats %>%
  dplyr::select(r.squared, adj.r.squared, AIC, BIC) %>%
  knitr::kable(
    digits = 3,
    caption = "Model fit statistics."
  )
```

```{r, regression-plot-colored, echo=TRUE, message=FALSE, warning=FALSE}
library(broom)
library(ggplot2)

# Get the data actually used in the model
plot_data <- augment(reg_results$model)

ggplot(plot_data, aes(x = .fitted, y = PTS)) +
  geom_point(color = "#2E86AB", alpha = 0.6) +
  geom_abline(intercept = 0, slope = 1, linetype = "dashed", color = "gray40") +
  labs(
    x = "Predicted points per 36 minutes",
    y = "Actual points per 36 minutes",
    title = "Predicted vs actual points per 36 minutes"
  ) +
  theme_minimal()
```

## Interpretation

The linear regression model explained approximately 41% of the variation in players’ points per 36 minutes (R² = 0.41, Adjusted R² = 0.41). Field-goal percentage was the strongest predictor of scoring (β = 23.24, SE = 2.56, p < 0.001), followed by assists (β = 0.72, SE = 0.12, p < 0.001) and three-point percentage (β = 5.20, SE = 2.03, p = 0.011). Total rebounds showed a smaller, marginally significant positive effect (β = 0.15, SE = 0.09, p = 0.082). These findings indicate that players who shoot efficiently and contribute through playmaking tend to score more points per 36 minutes, while rebounding provides a weaker but still positive contribution to scoring performance.


# Summary of findings 

Overall, the analysis shows that players who shoot efficiently, make plays for teammates, and contribute on the boards tend to have higher scoring averages per 36 minutes. Shooting accuracy, measured through field-goal and three-point percentages, appears to have the strongest impact on scoring performance. Assists and rebounds also play meaningful roles, suggesting that well-rounded players who both create and capitalize on opportunities are generally the most productive scorers.